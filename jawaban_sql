1.

SELECT KODE_BARANG, NAMA_BARANG, SATUAN, KATEGORI, sum(TRANS_MASUK), COALESCE(sum(TRANS_KELUAR),0), (sum(TRANS_MASUK)-COALESCE(sum(TRANS_KELUAR),0)) as STOK_AKHIR
FROM (
SELECT b.KODE_BARANG, c.NAMA_BARANG, c.SATUAN, a.KATEGORI,

        CASE WHEN a.JENIS_TRANSAKSI ='MASUK' THEN sum(b.QTY) END AS TRANS_MASUK,
        CASE WHEN a.JENIS_TRANSAKSI ='KELUAR' THEN sum(b.QTY) END AS TRANS_KELUAR

    FROM `TRMUTASIHD` a join TRMUTASIDT b   using (no_transaksi) join MSBARANG c   using (KODE_BARANG)
where (a.TANGGAL BETWEEN '2021-01-01' AND '2021-02-28')
group by b.KODE_BARANG,c.NAMA_BARANG,c.SATUAN,a.KATEGORI,a.JENIS_TRANSAKSI
) as z
group by 1,2,3,4

2.

SELECT KATEGORI, SATUAN, sum(TRANS_MASUK), COALESCE(sum(TRANS_KELUAR),0), (sum(TRANS_MASUK)-COALESCE(sum(TRANS_KELUAR),0)) as STOK_AKHIR
FROM (
SELECT c.SATUAN, C.KATEGORI,

        CASE WHEN a.JENIS_TRANSAKSI ='MASUK' THEN sum(b.QTY) END AS TRANS_MASUK,
        CASE WHEN a.JENIS_TRANSAKSI ='KELUAR' THEN sum(b.QTY) END AS TRANS_KELUAR

    FROM `TRMUTASIHD` a join TRMUTASIDT b   using (no_transaksi) join MSBARANG c   using (KODE_BARANG)
where (a.TANGGAL BETWEEN '2021-01-01' AND '2021-02-28')
group by C.SATUAN,C.KATEGORI,a.JENIS_TRANSAKSI
) as z
group by 1,2

3.

SELECT KATEGORI, SATUAN, KODE_BARANG, NAMA_BARANG, max(TRANS_KELUAR)
from (
SELECT C.KATEGORI, c.SATUAN, C.KODE_BARANG, C.NAMA_BARANG, sum(b.QTY) AS TRANS_KELUAR
    FROM `TRMUTASIHD` a join TRMUTASIDT b   using (no_transaksi) join MSBARANG c   using (KODE_BARANG)
where (a.TANGGAL BETWEEN '2021-01-01' AND '2021-02-28') AND A.JENIS_TRANSAKSI='KELUAR'
group by 1,2,3,4,a.JENIS_TRANSAKSI
) as z 
group by 1,2